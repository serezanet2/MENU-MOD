local player = game:GetService("Players").LocalPlayer
local TweenService = game:GetService("TweenService")
local HttpService = game:GetService("HttpService")

-- Конфигурация (проверьте URL перед использованием!)
local CONFIG = {
    API_URL = "https://serezanet2.github.io/GitUnlock/Gitmoder/?check=",
    MAIN_SCRIPT = "https://raw.githubusercontent.com/serezanet2/serezanet2-GIT-SALLI/main/script.lua",
    PROFILE_LINK = "https://serezanet2.github.io/GitUnlock/",
    VALID_KEYS = {"TESTKEY123", "GITMODER2023"} -- Резервные ключи
}

-- Создаем интерфейс
local gui = Instance.new("ScreenGui")
gui.Name = "GitmoderAuth_"..tostring(math.random(1000,9999))
gui.Parent = game:GetService("CoreGui")
gui.ResetOnSpawn = false

local mainFrame = Instance.new("Frame")
mainFrame.Size = UDim2.new(0, 500, 0, 300)
mainFrame.Position = UDim2.new(0.5, -250, 0.5, -150)
mainFrame.BackgroundColor3 = Color3.fromRGB(30, 30, 30)
mainFrame.BorderSizePixel = 0
mainFrame.Parent = gui

-- Градиентный фон
local gradient = Instance.new("UIGradient")
gradient.Color = ColorSequence.new({
    ColorSequenceKeypoint.new(0, Color3.fromRGB(40, 40, 40)),
    ColorSequenceKeypoint.new(1, Color3.fromRGB(80, 80, 80))
})
gradient.Rotation = 90
gradient.Parent = mainFrame

-- Элементы интерфейса (оригинальный дизайн)
local textBox = Instance.new("TextBox")
textBox.Size = UDim2.new(0, 300, 0, 40)
textBox.Position = UDim2.new(0.5, -150, 0.4, -20)
textBox.PlaceholderText = "Введите ключ доступа..."
textBox.Text = ""
textBox.TextColor3 = Color3.fromRGB(255, 255, 255)
textBox.BackgroundColor3 = Color3.fromRGB(50, 50, 50)
textBox.Parent = mainFrame

local submitBtn = Instance.new("TextButton")
submitBtn.Size = UDim2.new(0, 200, 0, 40)
submitBtn.Position = UDim2.new(0.5, -100, 0.6, 0)
submitBtn.Text = "АКТИВИРОВАТЬ"
submitBtn.TextColor3 = Color3.fromRGB(255, 255, 255)
submitBtn.BackgroundColor3 = Color3.fromRGB(0, 120, 255)
submitBtn.Parent = mainFrame

local statusLabel = Instance.new("TextLabel")
statusLabel.Size = UDim2.new(1, -40, 0, 30)
statusLabel.Position = UDim2.new(0, 20, 0.8, 0)
statusLabel.Text = ""
statusLabel.TextColor3 = Color3.fromRGB(255, 255, 255)
statusLabel.BackgroundTransparency = 1
statusLabel.Parent = mainFrame

-- Функция для отладки
local function debug(message)
    print("[Gitmoder] "..tostring(message))
    statusLabel.Text = tostring(message)
end

-- Проверка ключа (основная + резервная)
local function validateKey(key)
    key = string.gsub(tostring(key or ""), "%s+", "")
    if #key < 5 then return false end
    
    -- Проверка резервных ключей
    for _, validKey in pairs(CONFIG.VALID_KEYS) do
        if key == validKey then
            debug("Резервный ключ принят")
            return true
        end
    end
    
    -- Проверка через HTTP
    local success, result = pcall(function()
        if not HttpService:IsHttpGetEnabled() then
            error("HTTP запросы отключены")
        end
        
        debug("Отправка запроса...")
        local response = HttpService:GetAsync(CONFIG.API_URL..key, true)
        local data = HttpService:JSONDecode(response)
        return data.valid == true
    end)
    
    if not success then
        debug("Ошибка проверки: "..tostring(result))
    end
    
    return success and result
end

-- Загрузка основного скрипта
local function loadMainScript()
    local success, script = pcall(function()
        return HttpService:GetAsync(CONFIG.MAIN_SCRIPT, true)
    end)
    
    if success then
        local loadSuccess, err = pcall(loadstring, script)
        if loadSuccess then
            return true
        else
            debug("Ошибка загрузки: "..tostring(err))
        end
    else
        debug("Ошибка получения: "..tostring(script))
    end
    return false
end

-- Обработчик кнопки
submitBtn.MouseButton1Click:Connect(function()
    submitBtn.Text = "ПРОВЕРКА..."
    local key = textBox.Text
    
    if validateKey(key) then
        debug("Ключ действителен, загружаем...")
        if loadMainScript() then
            gui:Destroy()
            debug("Успешная активация!")
        end
    else
        debug("Неверный ключ!")
        task.wait(1.5)
        statusLabel.Text = ""
    end
    
    submitBtn.Text = "АКТИВИРОВАТЬ"
end)

-- Кнопка копирования ссылки
local copyBtn = Instance.new("TextButton")
copyBtn.Size = UDim2.new(0, 200, 0, 30)
copyBtn.Position = UDim2.new(0.5, -100, 0.75, 0)
copyBtn.Text = "СКОПИРОВАТЬ ССЫЛКУ"
copyBtn.Parent = mainFrame

copyBtn.MouseButton1Click:Connect(function()
    pcall(function()
        setclipboard(CONFIG.PROFILE_LINK)
        debug("Ссылка скопирована!")
    end)
end)

-- Анимация появления
mainFrame.Position = UDim2.new(0.5, -250, 0, -300)
TweenService:Create(mainFrame, TweenInfo.new(1, Enum.EasingStyle.Bounce), {
    Position = UDim2.new(0.5, -250, 0.5, -150)
}):Play()

debug("Интерфейс готов к работе")
